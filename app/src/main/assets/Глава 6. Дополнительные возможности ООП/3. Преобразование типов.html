<html lang="ru"><head>





<link href="../style/css.css" rel="stylesheet"></head>
<body>
<div id="container">

<div class="outercontainer">
<div class="innercontainer">
 
   <div class="item center menC">
     <h2>Преобразование типов</h2>
	

	<div style="margin-top:23px;margin-left:5px;">
		
		
		<!-- Yandex.RTB R-A-201190-1 -->
		
	</div>

	<p>Нередко может возникать задача по преобразованию типов, например, чтобы использовать данные одного типа в констексте, где требуются данные другого типа. 
В этом случае Kotlin представляет ряд возможностей по преобразованию типов.</p>
<h3>Встроенные методы преобразования типов</h3>
<p>Для преобразования данных одного типа в другой можно использовать встроенные следующие функции, которые есть у базовых типов (Int, Long, Double и т.д.) (Конкретный набор функций для разных базовых типов может отличаться. ):</p>
<ul>
<li><p><span class="b">toByte</span></p></li>
<li><p><span class="b">toShort</span></p></li>
<li><p><span class="b">toInt</span></p></li>
<li><p><span class="b">toLong</span></p></li>
<li><p><span class="b">toFloat</span></p></li>
<li><p><span class="b">toDouble</span></p></li>
<li><p><span class="b">toChar</span></p></li>
</ul>
<p>Все эти функции преобразуют данные в тот тип, которые идет после префикса to: to<span class="b">Byte</span>.</p>
<div><div id="highlighter_375900" class="syntaxhighlighter  kt"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="kt keyword">val</code> <code class="kt plain">s: String = </code><code class="kt string">"12"</code></div><div class="line number2 index1 alt1"><code class="kt keyword">val</code> <code class="kt plain">d: Int = s.toInt()</code></div><div class="line number3 index2 alt2"><code class="kt plain">println(d)</code></div></div></td></tr></tbody></table></div></div>
<p>В данном случае строка s преобразуется в число d. Просто так передать строку переменной типа Int, мы не можем, несмотря на то, что вроде бы строка 
и содержит число 12:</p>
<div><div id="highlighter_814226" class="syntaxhighlighter  kt"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="kt keyword">val</code> <code class="kt plain">d: Int = </code><code class="kt string">"12"</code>&nbsp;&nbsp; <code class="kt comments">// ! Ошибка</code></div></div></td></tr></tbody></table></div></div>
<p>Однако надо учитывать, что значение не всегда может быть преобразовано к определенному типу. И в этом случае генерируется исключение. Соответственно 
в таких случаях желательно отлавливать исключение:</p>
<div><div id="highlighter_72338" class="syntaxhighlighter  kt"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="kt keyword">val</code> <code class="kt plain">s: String = </code><code class="kt string">"tom"</code></div><div class="line number2 index1 alt1"><code class="kt keyword">try</code> <code class="kt plain">{</code></div><div class="line number3 index2 alt2"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt keyword">val</code> <code class="kt plain">d: Int = s.toInt()</code></div><div class="line number4 index3 alt1"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt plain">println(d)</code></div><div class="line number5 index4 alt2"><code class="kt plain">}</code></div><div class="line number6 index5 alt1"><code class="kt keyword">catch</code><code class="kt plain">(e: Exception){</code></div><div class="line number7 index6 alt2"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt plain">println(e.message)</code></div><div class="line number8 index7 alt1"><code class="kt plain">}</code></div></div></td></tr></tbody></table></div></div>
<h3>Smart cast и оператор is</h3>
<p>Оператор <span class="b">is</span> позволяет проверить выражение на принадлежность определенному типу данных:</p>
<div><div id="highlighter_264967" class="syntaxhighlighter  kt"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="kt plain">значение </code><code class="kt keyword">is</code> <code class="kt plain">тип_данных</code></div></div></td></tr></tbody></table></div></div>
<p>Этот оператор возвращает <code>true</code>, если значение слева от оператора принадлежит типу, указанному справа от оператора. Если локальная переменная или свойство успешно пройдет проверку 
на принадлежность определенному типу, то далее нет нужды дополнительно приводить значение к этому типу. 
Данные преобразования еще называются <span class="b">smart casts</span> или "умные преобразования".</p>
<p>Данный оператор можно применять как к базовым типам, но к собственным классам и интерфейсам, которые находятся в одной и той же иерархии наследования.</p>
<div><div id="highlighter_938678" class="syntaxhighlighter  kt"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="kt keyword">fun</code> <code class="kt plain">main() {</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt keyword">val</code> <code class="kt plain">tom = Person(</code><code class="kt string">"Tom"</code><code class="kt plain">)</code></div><div class="line number4 index3 alt1"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt keyword">val</code> <code class="kt plain">bob = Employee(</code><code class="kt string">"Bob"</code><code class="kt plain">, </code><code class="kt string">"JetBrains"</code><code class="kt plain">)</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt plain">checkEmployment(tom)&nbsp;&nbsp;&nbsp; </code><code class="kt comments">// Tom does not have a job</code></div><div class="line number7 index6 alt2"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt plain">checkEmployment(bob)&nbsp;&nbsp;&nbsp; </code><code class="kt comments">// Bob works in JetBrains</code></div><div class="line number8 index7 alt1"><code class="kt plain">}</code></div><div class="line number9 index8 alt2">&nbsp;</div><div class="line number10 index9 alt1"><code class="kt keyword">fun</code> <code class="kt plain">checkEmployment(person: Person){</code></div><div class="line number11 index10 alt2"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt comments">// println("${person.name} works in ${person.company}")&nbsp;&nbsp;&nbsp; // Ошибка - у Person нет свойства company</code></div><div class="line number12 index11 alt1"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt keyword">if</code><code class="kt plain">(person </code><code class="kt keyword">is</code> <code class="kt plain">Employee){</code></div><div class="line number13 index12 alt2"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt plain">println(</code><code class="kt string">"${person.name} works in ${person.company}"</code><code class="kt plain">)</code></div><div class="line number14 index13 alt1"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt plain">}</code></div><div class="line number15 index14 alt2"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt keyword">else</code><code class="kt plain">{</code></div><div class="line number16 index15 alt1"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt plain">println(</code><code class="kt string">"${person.name} does not have a job"</code><code class="kt plain">)</code></div><div class="line number17 index16 alt2"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt plain">}</code></div><div class="line number18 index17 alt1"><code class="kt plain">}</code></div><div class="line number19 index18 alt2"><code class="kt plain">open </code><code class="kt keyword">class</code> <code class="kt plain">Person(</code><code class="kt keyword">val</code> <code class="kt plain">name: String)</code></div><div class="line number20 index19 alt1"><code class="kt keyword">class</code> <code class="kt plain">Employee(name: String, </code><code class="kt keyword">val</code> <code class="kt plain">company: String): Person(name)</code></div></div></td></tr></tbody></table></div></div>
<p>Здесь класс Employee наследуется от класса Person. В функции <code>checkEmployment()</code> получаем объект Person. С помощью оператора <code>is</code> проверяем, 
представляет ли он тип Employee (так как не каждый объект Person может представлять тип Employee). 
Если он представляет тип Employee, то выводим название его компании, если он не представляет тип Employee, то выводим, сообщение, что он безработный.</p>

<p>Причем даже если значение представляет тип Employee, то до применения оператора is оно тем не менее принадлежит типу Person. И только 
применение оператора <code>is</code> преобразует значение из типа Person в тип Employee.</p>


<p>Также можно применять другую форму оператора - <span class="b">!is</span>. Она возвращает <code>true</code>, если значение НЕ представляет указанный тип данных:</p>
<div><div id="highlighter_959097" class="syntaxhighlighter  kt"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="kt keyword">fun</code> <code class="kt plain">main() {</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt keyword">val</code> <code class="kt plain">tom = Person(</code><code class="kt string">"Tom"</code><code class="kt plain">)</code></div><div class="line number4 index3 alt1"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt keyword">val</code> <code class="kt plain">bob = Employee(</code><code class="kt string">"Bob"</code><code class="kt plain">, </code><code class="kt string">"JetBrains"</code><code class="kt plain">)</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt plain">checkEmployment(tom)&nbsp;&nbsp;&nbsp; </code><code class="kt comments">// Tom does not have a job</code></div><div class="line number7 index6 alt2"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt plain">checkEmployment(bob)&nbsp;&nbsp;&nbsp; </code><code class="kt comments">// Bob works in JetBrains</code></div><div class="line number8 index7 alt1"><code class="kt plain">}</code></div><div class="line number9 index8 alt2">&nbsp;</div><div class="line number10 index9 alt1"><code class="kt keyword">fun</code> <code class="kt plain">checkEmployment(person: Person){</code></div><div class="line number11 index10 alt2"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt comments">// println("${person.name} works in ${person.company}")&nbsp;&nbsp;&nbsp; // Ошибка - у Person нет свойства company</code></div><div class="line number12 index11 alt1"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt keyword">if</code><code class="kt plain">(person !</code><code class="kt keyword">is</code> <code class="kt plain">Employee){</code></div><div class="line number13 index12 alt2"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt plain">println(</code><code class="kt string">"${person.name} does not have a job"</code><code class="kt plain">)</code></div><div class="line number14 index13 alt1"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt plain">}</code></div><div class="line number15 index14 alt2"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt keyword">else</code><code class="kt plain">{</code></div><div class="line number16 index15 alt1"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt plain">println(</code><code class="kt string">"${person.name} works in ${person.company}"</code><code class="kt plain">)</code></div><div class="line number17 index16 alt2"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt plain">}</code></div><div class="line number18 index17 alt1"><code class="kt plain">}</code></div><div class="line number19 index18 alt2"><code class="kt plain">open </code><code class="kt keyword">class</code> <code class="kt plain">Person(</code><code class="kt keyword">val</code> <code class="kt plain">name: String)</code></div><div class="line number20 index19 alt1"><code class="kt keyword">class</code> <code class="kt plain">Employee(name: String, </code><code class="kt keyword">val</code> <code class="kt plain">company: String): Person(name)</code></div></div></td></tr></tbody></table></div></div>

<p>Однако, что, если свойство <code>company</code> имеет пустую строку, например, <code>val bob = Employee("Bob", "")</code>, то есть фактически компания 
не указана. А мы хотим выводить компанию, если это свойство имеет какое-нибудь содержимое. В этом случае мы можем выполнить проверку на длину строку сразу же после применения оператора <code>is</code>:</p>
<div><div id="highlighter_560843" class="syntaxhighlighter  kt"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="kt keyword">fun</code> <code class="kt plain">checkEmployment(person: Person){</code></div><div class="line number2 index1 alt1"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt keyword">if</code><code class="kt plain">(person </code><code class="kt keyword">is</code> <code class="kt plain">Employee &amp;&amp; person.company.length &gt; 0){</code></div><div class="line number3 index2 alt2"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt plain">println(</code><code class="kt string">"${person.name} works in ${person.company}"</code><code class="kt plain">)</code></div><div class="line number4 index3 alt1"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt plain">}</code></div><div class="line number5 index4 alt2"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt keyword">else</code><code class="kt plain">{</code></div><div class="line number6 index5 alt1"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt plain">println(</code><code class="kt string">"${person.name} does not have a job"</code><code class="kt plain">)</code></div><div class="line number7 index6 alt2"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt plain">}</code></div><div class="line number8 index7 alt1"><code class="kt plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>в выражении</p>
<div><div id="highlighter_9593" class="syntaxhighlighter  kt"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="kt plain">person.company.length &gt; 0){</code></div></div></td></tr></tbody></table></div></div>
<p>компилятор уже видит, что person - это объект типа <code>Employee</code>, поэтому позволяет обращаться к его свойствам и функциям.</p>
<p>Если необходимо определить различные действия в зависимости от типа объекта, то удобно использовать конструкцию <span class="b">when</span>:</p>
<div><div id="highlighter_426852" class="syntaxhighlighter  kt"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="kt keyword">fun</code> <code class="kt plain">identifyPerson(person: Person){</code></div><div class="line number2 index1 alt1"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt keyword">when</code><code class="kt plain">(person){</code></div><div class="line number3 index2 alt2"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt keyword">is</code> <code class="kt plain">Manager -&gt; println(</code><code class="kt string">"${person.name} is a manager"</code><code class="kt plain">)</code></div><div class="line number4 index3 alt1"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt keyword">is</code> <code class="kt plain">Employee -&amp;t; println(</code><code class="kt string">"${person.name} is an employee"</code><code class="kt plain">)</code></div><div class="line number5 index4 alt2"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt keyword">is</code> <code class="kt plain">Person -&gt; println(</code><code class="kt string">"${person.name} is just a person"</code><code class="kt plain">)</code></div><div class="line number6 index5 alt1"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt plain">}</code></div><div class="line number7 index6 alt2"><code class="kt plain">}</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="kt plain">open </code><code class="kt keyword">class</code> <code class="kt plain">Person(</code><code class="kt keyword">val</code> <code class="kt plain">name: String)</code></div><div class="line number10 index9 alt1"><code class="kt plain">open </code><code class="kt keyword">class</code> <code class="kt plain">Employee(name: String, </code><code class="kt keyword">val</code> <code class="kt plain">company: String): Person(name)</code></div><div class="line number11 index10 alt2"><code class="kt keyword">class</code> <code class="kt plain">Manager(name: String, company: String): Employee(name, company)</code></div></div></td></tr></tbody></table></div></div>
<h4>Ограничения умных преобразований</h4>
<p>Подобные smart-преобразования тем не менее имеют ограничения. Они могут применяться, только если 
компилятор может гарантировать, что переменная не изменила своего значения в промежутке между проверкой и использованием. 
Для smart-преобразований действуют следующие правила:</p>
<ol>
<li><p>smart-преобразования применяются к локальным val-переменным (за исключением делегированных свойств)</p></li>
<li><p>smart-преобразования применяются к val-свойствам, за исключением свойств с модификатором <code>open</code> 
(то есть открытых к переопределению в производных классах) или свойств, для которых явным образом определен геттер</p></li>
<li><p>smart-преобразования применяются к локальным var-переменным (то есть к переменным, определенным в функциях), если 
переменная не изменяет своего значения в промежутке между проверкой и использованием и не используется в лямбда-выражении, которое изменяет ее, а также не является локальным делегированным свойством</p></li>
<li><p>к var-свойствам smart-преобразования не применяются</p></li>
</ol>
<p>Рассмотрим некоторые случаи. Возьмем последнее правило про var-свойства:</p>
<div><div id="highlighter_69269" class="syntaxhighlighter  kt"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="kt keyword">fun</code> <code class="kt plain">main() {</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt keyword">val</code> <code class="kt plain">tom = Person(</code><code class="kt string">"Tom"</code><code class="kt plain">)</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt keyword">if</code><code class="kt plain">(tom.phone </code><code class="kt keyword">is</code> <code class="kt plain">SmartPhone){</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt plain">println(</code><code class="kt string">"SmartPhone: ${tom.phone.name}, OS: ${tom.phone.os}"</code><code class="kt plain">)&nbsp;&nbsp; </code><code class="kt comments">// ! Ошибка</code></div><div class="line number8 index7 alt1"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt plain">}</code></div><div class="line number9 index8 alt2"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt keyword">else</code><code class="kt plain">{</code></div><div class="line number10 index9 alt1"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt plain">println(</code><code class="kt string">"Phone: ${tom.phone.name}"</code><code class="kt plain">)</code></div><div class="line number11 index10 alt2"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt plain">}</code></div><div class="line number12 index11 alt1"><code class="kt plain">}</code></div><div class="line number13 index12 alt2"><code class="kt plain">open </code><code class="kt keyword">class</code> <code class="kt plain">Phone(</code><code class="kt keyword">val</code> <code class="kt plain">name: String)</code></div><div class="line number14 index13 alt1"><code class="kt keyword">class</code> <code class="kt plain">SmartPhone(name: String, </code><code class="kt keyword">val</code> <code class="kt plain">os: String) : Phone(name)</code></div><div class="line number15 index14 alt2">&nbsp;</div><div class="line number16 index15 alt1"><code class="kt plain">open </code><code class="kt keyword">class</code> <code class="kt plain">Person(</code><code class="kt keyword">val</code> <code class="kt plain">name: String){</code></div><div class="line number17 index16 alt2"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt keyword">var</code> <code class="kt plain">phone: Phone = SmartPhone(</code><code class="kt string">"Pixel 5"</code><code class="kt plain">, </code><code class="kt string">"Android"</code><code class="kt plain">)</code></div><div class="line number18 index17 alt1"><code class="kt plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>Здесь класс Person хранит var-свойство класса Phone, которому присваивается объект класса SmartPhone. Соответственно в выражении:</p>
<div><div id="highlighter_5431" class="syntaxhighlighter  kt"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="kt keyword">if</code><code class="kt plain">(tom.phone </code><code class="kt keyword">is</code> <code class="kt plain">SmartPhone){</code></div></div></td></tr></tbody></table></div></div>
<p>очевидно, что свойство <code>tom.phone</code> представляет класс SmartPhone, однако поскольку это свойство определено с помощью <span class="b">var</span>, то к нему 
не применяются smart-преобразования. То есть если в данном случае мы заменим <code>var</code> на <span class="b">val</span>, то у нас проблем не возникнет.</p>
<p>Или второе правило - изменим класс Person, определив для свойства геттер:</p>
<div><div id="highlighter_721846" class="syntaxhighlighter  kt"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="kt plain">open </code><code class="kt keyword">class</code> <code class="kt plain">Person(</code><code class="kt keyword">val</code> <code class="kt plain">name: String){</code></div><div class="line number2 index1 alt1"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt keyword">val</code> <code class="kt plain">phone: Phone</code></div><div class="line number3 index2 alt2"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt plain">get()&nbsp; = SmartPhone(</code><code class="kt string">"Pixel 5"</code><code class="kt plain">, </code><code class="kt string">"Android"</code><code class="kt plain">)</code></div><div class="line number4 index3 alt1"><code class="kt plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>В соответствии с вторым правилом опять же к такому свойству не применяются smart-преобразования, так как оно имеет геттер.</p>

<h3>Явные преобразования и оператор as</h3>
<p>С помощью оператора <span class="b">as</span> мы можем приводить значения одного типа к другому типу:</p>
<div><div id="highlighter_837950" class="syntaxhighlighter  kt"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="kt plain">значение </code><code class="kt keyword">as</code> <code class="kt plain">тип_данных</code></div></div></td></tr></tbody></table></div></div>
<p>Слева от оператора указывается значение, а справа - тип данных, в которых надо преобразовать значение. Например, преобразуем значение типа <code>String?</code> в тип 
<code>String</code>:</p>
<div><div id="highlighter_621242" class="syntaxhighlighter  kt"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="kt keyword">fun</code> <code class="kt plain">main() {</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt keyword">val</code> <code class="kt plain">hello: String? = </code><code class="kt string">"Hello Kotlin"</code></div><div class="line number4 index3 alt1"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt keyword">val</code> <code class="kt plain">message: String = hello </code><code class="kt keyword">as</code> <code class="kt plain">String</code></div><div class="line number5 index4 alt2"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt plain">println(message)</code></div><div class="line number6 index5 alt1"><code class="kt plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>Здесь переменная <code>hello</code> хранит строку и может быть удачно преобразована в значение типа <code>String</code>. Однако если переменная hello равна <code>null</code>:</p>
<div><div id="highlighter_391722" class="syntaxhighlighter  kt"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="kt keyword">val</code> <code class="kt plain">hello: String? = </code><code class="kt keyword">null</code></div><div class="line number2 index1 alt1"><code class="kt keyword">val</code> <code class="kt plain">message: String = hello </code><code class="kt keyword">as</code> <code class="kt plain">String</code></div><div class="line number3 index2 alt2"><code class="kt plain">println(message)</code></div></div></td></tr></tbody></table></div></div>
<p>В этом случае преобразование завершится неудачно - ведь значение null нельзя преобразовать в значение типа <code>String</code>. Поэтому будет 
сгенерировано исключение <span class="b">NullPointerException</span>.</p>
<p>Чтобы избежать генерации исключения мы можем применять более безопасную версию оператора <span class="b">as?</span>, которая в случае неудачи 
преобразования возвращает null.</p>
<div><div id="highlighter_630337" class="syntaxhighlighter  kt"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="kt keyword">val</code> <code class="kt plain">hello: String? = </code><code class="kt keyword">null</code></div><div class="line number2 index1 alt1"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt keyword">val</code> <code class="kt plain">message: String? = hello </code><code class="kt keyword">as</code><code class="kt plain">? String</code></div><div class="line number3 index2 alt2"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt plain">println(message)</code></div></div></td></tr></tbody></table></div></div>
<p>В данном случае оператор <code>as?</code> возвратит null, так как null нельзя преобразовать в строку.</p>
<p>Также можно применять данный оператор к преобразованиям своих типов:</p>
<div><div id="highlighter_665759" class="syntaxhighlighter  kt"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="kt keyword">fun</code> <code class="kt plain">main() {</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt keyword">val</code> <code class="kt plain">tom = Person(</code><code class="kt string">"Tom"</code><code class="kt plain">)</code></div><div class="line number4 index3 alt1"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt keyword">val</code> <code class="kt plain">bob = Employee(</code><code class="kt string">"Bob"</code><code class="kt plain">, </code><code class="kt string">"JetBrains"</code><code class="kt plain">)</code></div><div class="line number5 index4 alt2"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt plain">checkCompany(tom)</code></div><div class="line number6 index5 alt1"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt plain">checkCompany(bob)</code></div><div class="line number7 index6 alt2"><code class="kt plain">}</code></div><div class="line number8 index7 alt1"><code class="kt keyword">fun</code> <code class="kt plain">checkCompany(person: Person){</code></div><div class="line number9 index8 alt2"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt keyword">val</code> <code class="kt plain">employee = person </code><code class="kt keyword">as</code><code class="kt plain">? Employee</code></div><div class="line number10 index9 alt1"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt keyword">if</code> <code class="kt plain">(employee!=</code><code class="kt keyword">null</code><code class="kt plain">){</code></div><div class="line number11 index10 alt2"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt plain">println(</code><code class="kt string">"${employee.name} works in ${employee.company}"</code><code class="kt plain">)</code></div><div class="line number12 index11 alt1"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt plain">}</code></div><div class="line number13 index12 alt2"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt keyword">else</code><code class="kt plain">{</code></div><div class="line number14 index13 alt1"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt plain">println(</code><code class="kt string">"${person.name} is not an employee"</code><code class="kt plain">)</code></div><div class="line number15 index14 alt2"><code class="kt spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="kt plain">}</code></div><div class="line number16 index15 alt1"><code class="kt plain">}</code></div><div class="line number17 index16 alt2"><code class="kt plain">open </code><code class="kt keyword">class</code> <code class="kt plain">Person(</code><code class="kt keyword">val</code> <code class="kt plain">name: String)</code></div><div class="line number18 index17 alt1"><code class="kt plain">open </code><code class="kt keyword">class</code> <code class="kt plain">Employee(name: String, </code><code class="kt keyword">var</code> <code class="kt plain">company: String): Person(name)</code></div></div></td></tr></tbody></table></div></div>
<p>Здесь функция <code>checkCompany()</code> принимает объект класса Person и пытается преобразовать его в объект типа Employee, который унаследован от Employee. 
Но если каждый объект Employee представляет также объект Person (каждый работник является человеком), то не каждый объект Person представляет объект Employee 
(не каждый человек является работником). И в этом случае чтобы получить значение типа Employee, применяется оператор <span class="b">as?</span>. Если объект 
person представляет тип Employee, то возвращается объект этого типа, иначе возвращается <code>null</code>. И далее мы можем проверить на значение null и выполнить те или иные действия.</p>
<p>Консольный вывод программы:</p>
<div class="console">
<pre class="consoletext">Tom is not an employee
Bob works in JetBrains
</pre>
</div>
	
	<div style="margin-top:25px;">

	
	</div>

	
	

	<div class="commentABl" style="clear:both;margin: 25px 5px 15px 5px;">
	
	
	
	</div>

	
	

  </div>

	
</div>

  
</div>


</div>














</body></html>